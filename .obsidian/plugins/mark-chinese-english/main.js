/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var C=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var D=Object.prototype.hasOwnProperty;var P=(r,i)=>{for(var e in i)C(r,e,{get:i[e],enumerable:!0})},L=(r,i,e,t)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of A(i))!D.call(r,n)&&n!==e&&C(r,n,{get:()=>i[n],enumerable:!(t=E(i,n))||t.enumerable});return r};var T=r=>L(C({},"__esModule",{value:!0}),r);var H={};P(H,{default:()=>f});module.exports=T(H);var o=require("obsidian"),x={autoConvertDelay:100};function V(r,i){let e=!1,t="";for(let n=0;n<=i;n++){let a=r[n].match(/^(```|~~~)/);a&&(e?a[1]===t&&(e=!1,t=""):(e=!0,t=a[1]))}return e}function B(r){let i=[{trigger:"\xB7\xB7\xB7 ",replacement:"``````"},{trigger:"\xB7 ",replacement:"``"},{trigger:"\u300B ",replacement:">"},{trigger:"\u3009 ",replacement:">"}],e=!1,t="",n=!1;for(let s=0;s<r.length;s++){let a=r[s];if(a==="`"){e=!e,t+=a;continue}if(!e){let m=!1;for(let u of i){let d=u.trigger.length;if(r.substring(s,s+d)===u.trigger){t+=u.replacement,s+=d-1,n=!0,m=!0;break}}if(m)continue}t+=a}return{newLine:t,replaced:n}}function k(r,i){let e;return()=>{e!==void 0&&clearTimeout(e),e=window.setTimeout(()=>{r()},i)}}var f=class extends o.Plugin{async onload(){await this.loadSettings(),this.onEditHandler=k(()=>{let e=this.app.workspace.getActiveViewOfType(o.MarkdownView);if(e){let t=e.editor;this.convertPatterns(t)}},this.settings.autoConvertDelay),this.registerEvent(this.app.workspace.on("editor-change",this.onEditHandler)),this.addSettingTab(new w(this.app,this))}onunload(){console.log("Auto Convert Chars Plugin Unloaded.")}async loadSettings(){this.settings=Object.assign({},x,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}updateAutoConvertDelay(e){this.settings.autoConvertDelay=e,this.saveSettings(),this.app.workspace.off("editor-change",this.onEditHandler),this.onEditHandler=k(()=>{let t=this.app.workspace.getActiveViewOfType(o.MarkdownView);if(t){let n=t.editor;this.convertPatterns(n)}},this.settings.autoConvertDelay),this.registerEvent(this.app.workspace.on("editor-change",this.onEditHandler))}convertPatterns(e){let t=e.getCursor(),n=t.line,s=e.getLine(n),a=e.getValue().split(`
`);if(V(a,n))return;let{newLine:u,replaced:d}=B(s);if(d){let b=s.substring(0,t.ch),l=-1,y=0,c=null,S=[{trigger:"\xB7\xB7\xB7 ",replacement:"``````"},{trigger:"\xB7 ",replacement:"``"},{trigger:"\u300B ",replacement:">"},{trigger:"\u3009 ",replacement:">"}];for(let g of S){let p=b.lastIndexOf(g.trigger);if(p!==-1){l=p,y=g.trigger.length,c=g;break}}if(l!==-1&&c!==null){let g={line:n,ch:l},p={line:n,ch:l+y},v=c.replacement;if(v){e.replaceRange(v,g,p);let h;c.trigger==="\xB7 "?h=l+1:c.trigger==="\xB7\xB7\xB7 "?h=l+3:h=l+v.length,e.setCursor({line:n,ch:h}),new o.Notice("\u2728 Auto Convert Markdown Chars \u2728")}}}}},w=class extends o.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Auto Convert Chars \u8BBE\u7F6E"}),new o.Setting(e).setName("\u81EA\u52A8\u8F6C\u6362\u5EF6\u8FDF\uFF08\u6BEB\u79D2\uFF09").setDesc("\u8BBE\u7F6E\u81EA\u52A8\u8BC6\u522B\u5E76\u8F6C\u6362\u7279\u5B9A\u5B57\u7B26\u7EC4\u5408\u7684\u5EF6\u8FDF\u65F6\u95F4\uFF0C\u9ED8\u8BA4100\u6BEB\u79D2\u3002").addText(t=>t.setPlaceholder("100").setValue(this.plugin.settings.autoConvertDelay.toString()).onChange(async n=>{let s=parseInt(n);!isNaN(s)&&s>=0?(this.plugin.updateAutoConvertDelay(s),new o.Notice(`\u81EA\u52A8\u8F6C\u6362\u5EF6\u8FDF\u5DF2\u8BBE\u7F6E\u4E3A ${s} \u6BEB\u79D2`)):new o.Notice("\u8BF7\u8F93\u5165\u6709\u6548\u7684\u6BEB\u79D2\u6570\uFF08\u975E\u8D1F\u6574\u6570\uFF09\u3002")}))}};
